{
    "app-id": "org.gnome.gitlab.somas.Apostrophe",
    "runtime": "org.gnome.Platform",
    "runtime-version": "43",
    "sdk": "org.gnome.Sdk",
    "command": "apostrophe",
    "finish-args": [
        "--socket=wayland",
        "--socket=fallback-x11",
        "--share=ipc",
        "--share=network",
        "--device=dri",
        "--filesystem=home:ro",
        "--env=PATH=/app/bin:/usr/bin:/app/extensions/TexLive/2018/bin/x86_64-linux/"
    ],
    "add-extensions": {
        "org.gnome.gitlab.somas.Apostrophe.Plugin": {
            "directory": "extensions",
            "version": "stable",
            "subdirectories": true,
            "no-autodownload": true,
            "autodelete": true
        }
    },
    "modules": [

        {
            "name": "pandoc",
            "only-arches": [
                "x86_64"
            ],
            "buildsystem": "simple",
            "build-commands": [
                "mkdir /app/bin",
                "cp bin/pandoc /app/bin/pandoc"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/jgm/pandoc/releases/download/2.19.2/pandoc-2.19.2-linux-amd64.tar.gz",
                    "sha256": "9d55c7afb6a244e8a615451ed9cb02e6a6f187ad4d169c6d5a123fa74adb4830"
                }
            ]
        },
        {
            "name": "pipdeps",
            "buildsystem": "simple",
            "build-commands": [
                "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} regex pypandoc chardet"
            ],
            "sources": [
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/c0/6c/9f840c2e55b67b90745af06a540964b73589256cb10cc10057c87ac78fc2/wheel-0.37.1.tar.gz",
                    "sha256": "e9a504e793efbca1b8e0e9cb979a249cf4a0a7b5b8c9e8b65a5e39d49529c1c4"
                },
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/4b/30/e15b806597e67057e07a5acdc135216ccbf76a5f1681a324533b61066b0b/pip-22.2.2.tar.gz",
                    "sha256": "3fd1929db052f056d7a998439176d3333fa1b3f6c1ad881de1885c0717608a4b"
                },
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/cf/14/35d1a15f8b9b7cdc982c2322b89d43eebeab8f7eec431ff9846768a9d34b/pypandoc-1.9.tar.gz",
                    "sha256": "dbd6208ff1ff923072f53307926e8c40c71a9c8ba84e1b665e6cd011bebd4c07"
                },
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/f8/43/b85d103acc0bfb54939f801908bf83354085579e8422eeaa22c017950c02/regex-2022.9.13.tar.gz",
                    "sha256": "f07373b6e56a6f3a0df3d75b651a278ca7bd357a796078a26a958ea1ce0588fd"
                },
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/b1/a3/86763b6350727ca81c8fcc5bb5bccee416e902e0085dc7a902c81233717e/pyenchant-3.2.2.tar.gz",
                    "sha256": "1cf830c6614362a78aab78d50eaf7c6c93831369c52e1bb64ffae1df0341e637"
                },
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/27/ba/611a561ef300abdae81a576445334fb7a41e62c295b050338a4f54fa76d4/poetry-core-1.2.0.tar.gz",
                    "sha256": "ceccec95487e46c63a41761fbac5211b809bca22658e25a049f4c7da96269f71"
                },
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/31/a2/12c090713b3d0e141f367236d3a8bdc3e5fca0d83ff3647af4892c16c205/chardet-5.0.0.tar.gz",
                    "sha256": "0368df2bfd78b5fc20572bb4e9bb7fb53e2c094f60ae9993339e8671d0afb8aa"
                }
            ]
        },
        {
            "name": "fonts",
            "buildsystem": "simple",
            "build-commands": [
                "mkdir -p /app/share/fonts/",
                "cp ttf/* /app/share/fonts/"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/mozilla/Fira",
                    "tag": "4.202"
                }
            ]
        },
        {
            "name": "apostrophe",
            "buildsystem": "meson",
            "config-opts": [
                "-Dprofile=development"
            ],
            "sources": [
                {
                    "type": "dir",
                    "path": "../../"
                }
            ],
            "post-install": [
                "install -d /app/extensions"
            ]
        }
    ]
}